(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698,3937,6636],{6654:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return r}});let l=a(12115);function r(e,t){let a=(0,l.useRef)(null),r=(0,l.useRef)(null);return(0,l.useCallback)(l=>{if(null===l){let e=a.current;e&&(a.current=null,e());let t=r.current;t&&(r.current=null,t())}else e&&(a.current=n(e,l)),t&&(r.current=n(t,l))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},14268:(e,t,a)=>{Promise.resolve().then(a.bind(a,50880))},50880:(e,t,a)=>{"use strict";a.d(t,{default:()=>v});var l=a(95155),r=a(53607),n=a(77052),i=a(66766),s=a(30285),o=a(46671),u=a(12115),d=a(34477);let c=(0,d.createServerReference)("7f35c3a4c7e92eb564a05a61e61febc7bb10c1a413",d.callServer,void 0,d.findSourceMapURL,"updateProfile");var f=a(94631),m=a(84355),p=a(56671),g=a(12108),b=a(26446),h=a(76981),x=a(58918),y=a(52596);let v=function(e){var t,a;let{user:d}=e,{data:m,update:v}=(0,g.useSession)(),[N,w]=(0,u.useState)(null!=(t=d.image)?t:""),[R,k]=(0,u.useState)(d.role===o.UserRole.ADMIN),[S,A]=(0,u.useState)(null),P=(0,u.useCallback)(()=>{let e=new FormData;return Object.entries(d).forEach(t=>{let[a,l]=t;null!=l&&"image"!==a&&e.append(a,l.toString())}),e},[d]),_={message:"",error:{},status:null,formData:P()},[C,D,E]=(0,u.useActionState)(c.bind(null,R),_),{getFormFields:M}=(0,n.A)({slug:r.BV.PROFILE});(0,u.useEffect)(()=>{if(C.message&&"number"==typeof C.status&&!E&&C.message!==S){p.oR.dismiss("profile-update-loading");let e=200===C.status;p.oR[e?"success":"error"](C.message,{style:{color:e?"#34c759":"#ef4444",backgroundColor:e?"#f0fdf4":"#fef2f2",border:"1px solid ".concat(e?"#dcfce7":"#fee2e2"),borderRadius:"8px",padding:"12px"},duration:3e3}),A(C.message),e&&v({...m,user:{...null==m?void 0:m.user,role:R?o.UserRole.ADMIN:o.UserRole.USER,image:N}})}},[E,C.message,C.status,m,v,R,N,S]),(0,u.useEffect)(()=>{var e;w(null!=(e=d.image)?e:"")},[d.image]);let O=(0,u.useCallback)(e=>{e.preventDefault();let t="Saving...";t!==S&&(p.oR.loading(t,{id:"profile-update-loading",style:{borderRadius:"8px",padding:"12px",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb"}}),A(t)),(0,u.startTransition)(()=>{D(new FormData(e.currentTarget))})},[D,S]);return(0,l.jsxs)(x.P.form,{onSubmit:O,className:"flex flex-col md:flex-row gap-10 p-6 bg-black shadow-lg rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,l.jsxs)(x.P.div,{className:"group relative w-[200px] h-[200px] overflow-hidden rounded-full mx-auto border-2 border-indigo-700",whileHover:{scale:1.05},children:[N?(0,l.jsx)(i.default,{src:N,alt:null!=(a=d.name)?a:"User Avatar",width:200,height:200,className:"rounded-full object-cover"}):(0,l.jsx)(i.default,{src:"https://i.postimg.cc/kg2xytVs/610e8961bbb935274c005c6106a78a38.jpg",alt:"Default Cat Avatar",width:200,height:200,className:"rounded-full object-cover"}),(0,l.jsx)("div",{className:(0,y.A)("absolute top-0 left-0 w-full h-full flex items-center justify-center rounded-full transition-opacity duration-200",N&&"group-hover:opacity-100 opacity-0 transition-opacity duration-200"),children:(0,l.jsx)(j,{setSelectedImage:w})})]}),(0,l.jsxs)(x.P.div,{className:"flex-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[M().map(e=>{var t,a,n,i;let s=null!=(i=null==C||null==(t=C.formData)?void 0:t.get(e.name))?i:P().get(e.name);return(0,l.jsx)(x.P.div,{className:"mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,l.jsx)(b.A,{...e,type:e.type,defaultValue:s,error:null==C||null==(n=C.error)||null==(a=n[e.name])?void 0:a.join(", "),readonly:e.type===r.gN.EMAIL,disabled:E})},e.name)}),(null==m?void 0:m.user.role)===o.UserRole.ADMIN&&(0,l.jsxs)(x.P.div,{className:"flex items-center gap-2 my-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[(0,l.jsx)(h.Sc,{id:"admin",name:"admin",checked:R,onCheckedChange:e=>k(e),className:(0,y.A)("w-5 h-5 border-2 rounded-md transition-all",R?"bg-indigo-700 border-indigo-700":"bg-black border-black")}),(0,l.jsx)("label",{htmlFor:"admin",className:"text-indigo-700 font-medium cursor-pointer",children:"Admin"})]}),(0,l.jsx)(x.P.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3},children:(0,l.jsx)(s.$,{type:"submit",disabled:E,className:(0,y.A)("w-full bg-indigo-700 hover:bg-indigo-700 text-black font-bold py-2 px-4 rounded-lg transition-all",E&&"opacity-50 cursor-not-allowed flex items-center justify-center gap-2"),children:E?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"Saving..."})]}):"Save"})})]})]})},j=e=>{let{setSelectedImage:t}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:e=>{var a;let l=null==(a=e.target.files)?void 0:a[0];l&&t(URL.createObjectURL(l))},name:"image"}),(0,l.jsx)("label",{htmlFor:"image-upload",className:"flex justify-center items-center w-full h-full cursor-pointer ml-1 rounded-full hover:bg-indigo-700/700 transition-all",children:(0,l.jsx)(m.A,{className:"w-10 h-10 text-indigo-700"})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1799,8918,8548,7951,3063,2108,3030,2563,8441,1684,7358],()=>t(14268)),_N_E=e.O()}]);